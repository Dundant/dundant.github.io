I"<blockquote>
  <p>Copula 到底有啥用？？？如何去理解？？？又如何应用到实际上呢？？？</p>
</blockquote>

<h2 id="分布的相关性描述">分布的相关性描述</h2>

<p>长期以来，针对数据间的相关性用<strong>相关系数</strong>去描述。但是，仔细想，这其中其实存在问题。</p>

<blockquote>
  <p>相关系数是分布平均化后的结果</p>
</blockquote>

<p>相关系数是一个标量，从它的由来而言，相关系数实际上表示的是，两个样本所对应的总体的相关性。而这种相关性是分布的平均化的结果，也就是说，两个分布出现对应各自对应观测值的相关性是没有被这个相关系数所描述的。</p>

<p>用更加具体的例子描述，存在两个总体，如果从第一个总体中抽出某一个个体，我们是不能用两个总体间相关系数去描述，从第二个总体抽出某个<strong>相对应</strong>个体的与前一个个体的相关性。</p>

<blockquote>
  <p>那么一个更好的描述相关性的量是什么呢？</p>
</blockquote>

<p>总的来说，这个量也应该是某个分布，可以刚好的描述每一个不同分布的之间的每一个点的相关性。</p>

<h2 id="概率积分变换">概率积分变换</h2>

<p><strong>概率积分变换 ( Probability Integral Transform )</strong> 是把任意连续分布转换成一个标准均匀分布 ( Standard Uniform Distribution )，而不改变相关性的方法。</p>

<h3 id="定义">定义</h3>

<p>随机变量 $ X $ 服从任意连续分布，其累积分布函数 ( Cumulative Distribution Function ) 是 $ F_X(x) $ 。那么 $ U $ 服从标准均匀分布，如果 $ U $ 定义满足：</p>

<script type="math/tex; mode=display">U = F_X(x)</script>

<h3 id="证明">证明</h3>

<p>略</p>

<h3 id="相关性不变的证明">相关性不变的证明</h3>

<p>未知</p>

<h2 id="copula-函数">Copula 函数</h2>

<h3 id="定义-1">定义</h3>

<p>两个随机变量 $ X , Y$ 都服从任意连续分布，那么经过概率积分变换得到的相对应的 $ U_1, U_2 $ 服从联合概率分布。该联合概率分布的累积分布函数就是 Copula 函数。</p>

<p>多元形式的 Copula 函数定义类似。</p>

<h3 id="sklar-定理"><a href="https://en.wikipedia.org/wiki/Copula_(probability_theory)#Sklar's_theorem">Sklar 定理</a></h3>

<p>（摘自英文维基百科 Copula 条目）</p>

<p>Every <a href="https://en.wikipedia.org/wiki/Cumulative_distribution_function#Multivariate_case">multivariate cumulative distribution function</a>  $ H(x_1, x_2, … ,x_d)=Pr[X_1\leq x_1, X_2 \leq x_2, …, X_d \leq x_d] $  of of a random vector $ (X_1, X_2, …, X_d) $ can be expressed in terms of its marginals $ F_i(x_i) = Pr[X_i \leq x_i] $ and a copula $ C$. Indeed:</p>

<script type="math/tex; mode=display">H(x_1, x_2, ... ,x_d)=C(F_1(x_1), F_2(x_2), ..., F_d(x_d))</script>

<p>In case that the multivariate distribution has a density $h$ available, it holds further that</p>

<script type="math/tex; mode=display">h(x_1, x_2, ... ,x_d)=
c(F_1(x_1), F_2(x_2), ..., F_d(x_d)) \times f_1(x_1) \times f_2(x_2) \times \dots \times f_d(x_d)</script>

<p>where $ c$ is the density of the copula.</p>

<p>翻译一下就是：</p>

<p>一个随机向量 $ (X_1, X_2, …, X_d) $ 的多元联合累计分布函数 $ H(x_1, x_2, … ,x_d)=Pr[X_1\leq x_1, X_2 \leq x_2, …, X_d \leq x_d] $ 可以用每一个边缘分布函数和 Copula 函数表示为：</p>

<script type="math/tex; mode=display">H(x_1, x_2, ... ,x_d)=C(F_1(x_1), F_2(x_2), ..., F_d(x_d))</script>

<p>同时，如果该多远联合累计分布存在联合密度函数 $h$ . 下式成立：</p>

<script type="math/tex; mode=display">h(x_1, x_2, ... ,x_d)=
c(F_1(x_1), F_2(x_2), ..., F_d(x_d)) \times f_1(x_1) \times f_2(x_2) \times \dots \times f_d(x_d)</script>

<p>其中 $c$ 是 Copula 分布函数的密度函数。</p>

<h3 id="证明-1">证明</h3>

<p>略</p>

<h3 id="意义">意义</h3>

<p>通过 Sklar 定理，我们可以发现，Copula 函数把联合概率密度分布划分成了两个部分：关联性结构和边缘密度函数。也就是说，我们成功地把用于描述相关性的量从联合分布中抓了出来。</p>

<h2 id="copula-在金融数据中的应用">Copula 在金融数据中的应用</h2>

:ET