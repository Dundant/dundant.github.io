
---
layout:     post
title:      如何理解 Copula
subtitle:   Copula and Applications in Finance
date:       2019-11-01
author:     Dundant
header-img: img/Marshall_Olkin_Copula_3D.png
catalog: true
tags:
    -math -数学 -概率 -金融 -finance
---

# 如何理解 Copula ？

> Copula 到底有啥用？？？如何去理解？？？又如何应用到实际上呢？？？

## 分布的相关性描述

长期以来，针对数据间的相关性用**相关系数**去描述。但是，仔细想，这其中其实存在问题。

> 相关系数是分布平均化后的结果

相关系数是一个标量，从它的由来而言，相关系数实际上表示的是，两个样本所对应的总体的相关性。而这种相关性是分布的平均化的结果，也就是说，两个分布出现对应各自对应观测值的相关性是没有被这个相关系数所描述的。

用更加具体的例子描述，存在两个总体，如果从第一个总体中抽出某一个个体，我们是不能用两个总体间相关系数去描述，从第二个总体抽出某个**相对应**个体的与前一个个体的相关性。

> 那么一个更好的描述相关性的量是什么呢？

总的来说，这个量也应该是某个分布，可以刚好的描述每一个不同分布的之间的每一个点的相关性。

## 概率积分变换

**概率积分变换 ( Probability Integral Transform )** 是把任意连续分布转换成一个标准均匀分布 ( Standard Uniform Distribution )，而不改变相关性的方法。

### 定义

随机变量 $ X $ 服从任意连续分布，其累积分布函数 ( Cumulative Distribution Function ) 是 $ F_X(x) $ 。那么 $ U $ 服从标准均匀分布，如果 $ U $ 定义满足：
$$
U = F_X(x)
$$

### 证明

略

### 相关性不变的证明

未知

## Copula 函数

### 定义

两个随机变量 $ X , Y$ 都服从任意连续分布，那么经过概率积分变换得到的相对应的 $ U_1, U_2 $ 服从联合概率分布。该联合概率分布的累积分布函数就是 Copula 函数。

多元形式的 Copula 函数定义类似。

### [Sklar 定理](https://en.wikipedia.org/wiki/Copula_(probability_theory)#Sklar's_theorem)

Every [multivariate cumulative distribution function](https://en.wikipedia.org/wiki/Cumulative_distribution_function#Multivariate_case)  $ H(x_1, x_2, ... ,x_d)=Pr[X_1\leq x_1, X_2 \leq x_2, ..., X_d \leq x_d] $  of of a random vector $ (X_1, X_2, ..., X_d) $ can be expressed in terms of its marginals $ F_i(x_i) = Pr[X_i \leq x_i] $ and a copula $ C$. Indeed:
$$
H(x_1, x_2, ... ,x_d)=C(F_1(x_1), F_2(x_2), ..., F_d(x_d))
$$
In case that the multivariate distribution has a density $h$ available, it holds further that
$$
h(x_1, x_2, ... ,x_d)=\\
c(F_1(x_1), F_2(x_2), ..., F_d(x_d)) \times f_1(x_1) \times f_2(x_2) \times \dots \times f_d(x_d)
$$
where $ c$ is the density of the copula.

### 意义

通过 Sklar 定理，我们可以发现，Copula 函数把联合分布的
